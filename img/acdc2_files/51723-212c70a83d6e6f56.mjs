(self.modernJsonp=self.modernJsonp||[]).push([["51723"],{95664:function(e,t,n){n.d(t,{$K:()=>l,dh:()=>a,ry:()=>i,xX:()=>s});let a=e=>/instagram/i.test(e||""),i=e=>a(e)||/facebook/i.test(e||"")||/line/i.test(e||"")||/wechat/i.test(e||""),o="[Pinterest/Android]",l=e=>(e||"").includes("[Pinterest/iOS]")||(e||"").includes(o),s=e=>(e||"").includes(o)},994507:function(e,t,n){n.d(t,{Ak:()=>u,Jr:()=>g,LG:()=>O,MK:()=>a,PW:()=>b,R8:()=>l,UF:()=>r,UO:()=>I,XN:()=>d,ZB:()=>C,_h:()=>h,cH:()=>o,dm:()=>E,fE:()=>w,fu:()=>p,iK:()=>y,iN:()=>i,js:()=>c,nZ:()=>m,ne:()=>s,pn:()=>S,tf:()=>v,vE:()=>_});let a=0,i=0,o=0,l=0,s=0,r="",d="",u="",p="",_="",c="",h="desktop",g=0,m={browserName:"",browserType:null,browserVersion:"",canUseNativeApp:!1,isTablet:!1,isMobile:!1,platform:"",platformVersion:[0,0,0],osName:null,raw:""},b=[],v=[],w=[],y=[],S=[],O=100,I=10,C=28,E=()=>({count:1,time:0,ts:Date.now()})},589172:function(e,t,n){n.d(t,{Z:()=>i});var a=n(501010);function i(e){let{expName:t,anyEnabled:n,group:i}=function({experimentsClient:e,skipActivation:t}){let{checkExperiment:n}=e,a=n("web_masonry_v2",{dangerouslySkipActivation:t});return a.group?{expName:"web_masonry_v2",...a}:{expName:"",anyEnabled:!1,group:""}}({experimentsClient:(0,a.Z)(),skipActivation:e?.skipActivation??!1});return{expName:t,anyEnabled:n,group:i,isMeasureAllEnabled:"enabled_measure_all"===i||"enabled_measure_all_impression_fix"===i,isImpressionFixEnabled:"control_impression_fix"===i||"enabled_impression_fix"===i||"enabled_measure_all_impression_fix"===i}}},79271:function(e,t,n){n.d(t,{Fw:()=>w,OC:()=>g,ZP:()=>v});var a=n(667294),i=n(230201),o=n(589172),l=n(609252),s=n(774838),r=n(739405),d=n(281213),u=n(358198),p=n(2061),_=n(767415),c=n(177433);let h=0,g=()=>h,m={ActivationCard:{impressionType:"activationCardImpressions",idType:"experienceIdStr",eventType:8547},Article:{impressionType:"articleImpressions",idType:"articleIdStr",eventType:3829},Banner:{impressionType:"bannerImpressions",idType:"userIdStr",eventType:9061},Board:{impressionType:"boardImpressions",idType:"boardIdStr",eventType:3700},Comment:{impressionType:"commentImpressions",idType:"commentIdStr",eventType:9127},Guide:{impressionType:"guideImpressions",idType:"term",eventType:7573},Interest:{impressionType:"topicImpressions",idType:"topicIdStr",eventType:3703},News:{impressionType:"newsHubData",idType:"newsIdStr",eventType:4110},OneBar:{impressionType:"oneBarImpressions",idType:"onebarIdStr",eventType:9993},Pin:{impressionType:"pinImpressions",idType:"pinIdStr",eventType:18},Search:{impressionType:"searchImpressions",idType:"term",eventType:3803},Story:{impressionType:"storyImpression",idType:"idStr",eventType:170},TodayArticle:{impressionType:"todayArticleImpressions",idType:"todayArticleIdStr",eventType:8569},User:{impressionType:"userImpressions",idType:"userIdStr",eventType:3704},AdsPreview:{impressionType:"AdsPreviewImpression",idType:"AdsPreviewStr",eventType:8600},BoardMoreIdeasRep:{impressionType:"boardMoreIdeasFeedUpsellImpressions",idType:"boardIdStr",eventType:10054},Notification:{impressionType:"notificationDetailImpressions",idType:"newsIdStr",eventType:4111},NotificationFeed:{impressionType:"notificationFeedImpressions",idType:"newsIdStr",eventType:4110},EditorialBoard:{impressionType:"editorialBoardImpressions",idType:"boardIdStr",eventType:3700},VaseAnnotation:{impressionType:"vaseAnnotationImpressions",idType:"vaseAnnotationUrlStr",eventType:16444}},b=({events:e,startTime:t,endTime:n})=>e?.filter(e=>e>=t&&e<=n)||[];function v({carouselData:e,closeupImpressionType:t,closeupNavigationType:n,componentType:g,contextLogData:v,clientTrackingParams:w,duploShouldTrackPinEvents:y,elementType:S,impressionAuxFields:O,inImpressionExp:I,impressionType:C,impressionsFramework:E,isPaused:f,loggingId:P,objectIdStr:T,slotIndex:L,trackCarousel:N,viewData:M,viewParameter:k,viewType:U,isPromoted:x,storyPinProductEventData:R}){let{logContextEvent:D}=(0,i.u)(),{logMrcVideoAdEventOnPlay:A}=(0,d.H)(),{addImpression:G}=(0,u.WW)()||{},{logStat:F}=(0,p.Yg)(),W=E||l.Z,H=(0,a.useRef)(null),q=(0,a.useRef)(e=>{});q.current=a=>{let i=m[C],o=i.idType,l={clientTrackingParams:w,endTime:a.endTime,[o]:P,slotIndex:L,time:a.startTime,renderDuration:a.endTime-a.startTime,type:t,...O,forcedExit:"removed"===a.forcedExit?0:void 0};if("Pin"===C){h+=1;let e=[],t=a.visibleEvents||new Map,n=a.hiddenEvents||new Map;(O&&O.isPromoted||x)&&[1,50,80,2,102].forEach(i=>{let o=b({events:t.get(i),startTime:a.startTime,endTime:a.endTime}),l=b({events:n.get(i),startTime:a.startTime,endTime:a.endTime});o.forEach(t=>{e.push({type:i,time:t||0,visible:!0})}),l.forEach(t=>{e.push({type:i,time:t||0,visible:!1})})}),l={...l,pinCellWidth:a.pinCellWidth||0,pinCellHeight:a.pinCellHeight||0,windowWidth:window?.innerWidth,windowHeight:window?.innerHeight,visibleEvents:e.sort((e,t)=>e.time-t.time)},O?.nearDupSignature&&G&&g&&[13007,13176,68].includes(g)&&G(O.nearDupSignature)}let s={component:g,object_id_str:T,view_type:U,view_data:M||{},view_parameter:k};if(N)e&&N&&D({event_type:7352,event_data:{pinCarouselSlotImpressions:[{...l,..."canonical"===e.type?{carouselDataId:Number(e.carouselId??0),slotIndex:e.index,carouselSlotId:e.carouselSlots?.[e.index??0]&&Number(e.carouselSlots[e.index??0].slotId)}:{carouselDataId:Number(e.id??0),carouselSlotId:e.carousel_slots?.[e.index??0]&&Number(e.carousel_slots[e.index??0].id),slotIndex:e.index}}]},...s,aux_data:{...v}});else{let e={clientTrackingParams:w,event_type:i.eventType,...s,element:S,event_data:{[i.impressionType]:"Story"===C?l:[l],...R?{storyPinProductEventData:R}:{}},aux_data:{closeup_navigation_type:n,...v}};D(e),A(e)}y&&F("log_pin_impression")};let{expName:B,group:V}=(0,o.Z)({skipActivation:!0}),$=(0,r.ZP)(),Z=(0,c.Zv)(),{isAuthenticated:K}=(0,s.B)(),Q=(0,a.useCallback)(()=>{let e=!1;try{let{current:t}=H;if(t instanceof HTMLElement&&(!x||t.getElementsByTagName("img").length>0)){let n=W.start(t);n.onExitViewport(q.current).setDebugId(P||"unknown"),y&&n.onEnterViewport(()=>{F("log_pin_impression_track_enter_viewport")}),e=!0,V&&(0,_.nP)("webapp.masonry.trackImpression",{tags:{callsite:"app_packages_useImpressionTracker",deviceType:$,experimentName:B,group:V,handlerId:Z,isAuthenticated:K,slotIndex:L??"unknown"}})}}catch{window.console.error('Can only track impressions for type "HTMLElement"')}y&&F("log_pin_impression_track",{didStartTracking:e})},[H.current]);return(0,a.useEffect)(()=>(I&&!W.inExperiment&&W.setExperimentStatus(!0),f||Q(),()=>{let{current:e}=H;e instanceof HTMLElement&&(!x||e.getElementsByTagName("img").length>0)&&W.stop(e)}),[f,Q]),H}let w=({children:e,...t})=>e({impressionTrackerRef:v(t)})},936367:function(e,t,n){function a(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z3:()=>p,ZP:()=>c,LU:()=>_});let i=window.location.search.includes("debug_impressions=1")||document.cookie&&document.cookie.indexOf("debug_impressions=1")>-1,o={paused:"Pause",resumed:"Resume",stopped:"Flush",enter:"Enter viewport",exit:"Exit viewport"},l={},s={background:"#FF8A8A",transform:"scale(.98)"},r={init:e=>({transform:`scale(${l[e]?.8:.99})`,transition:"transform .2s ease-in-out",background:"#8E8E8E"}),[o.enter]:{background:"#A0DCC8",transform:"scale(.99)"},[o.exit]:s,[o.stopped]:s,[o.paused]:s,[o.resumed]:{background:"#0FA573",transform:"scale(.99)"}};class d{constructor(e){a(this,"lastIntersectionChange",null),a(this,"setMutationObserver",e=>(this.mutationObserver=e,this)),a(this,"startMutationObserver",e=>{this.mutationObserver&&this.mutationObserver.observe(this.node,e)}),a(this,"stopMutationObserver",()=>{this.mutationObserver&&this.mutationObserver.disconnect()}),a(this,"handleIntersectionVisibilityChange",(e,t)=>{this.lastIntersectionChange=e,[{type:1,isVisible:e=>{let t=e.rootBounds?.bottom??window.innerHeight;return e.isIntersecting&&e.boundingClientRect.top>=143&&e.boundingClientRect.top<t},isHidden:e=>{let t=e.rootBounds?.bottom??window.innerHeight;return!e.isIntersecting||e.boundingClientRect.top<143||e.boundingClientRect.top>=t}},{type:50,isVisible:e=>e.intersectionRatio>=.5,isHidden:e=>e.intersectionRatio<.5},{type:80,isVisible:e=>e.intersectionRatio>=.8,isHidden:e=>e.intersectionRatio<.8},{type:2,isVisible:e=>{let t=e.rootBounds?.bottom??window.innerHeight;return e.isIntersecting&&e.boundingClientRect.bottom<=t&&e.boundingClientRect.bottom>=143},isHidden:e=>{let t=e.rootBounds?.bottom??window.innerHeight;return!e.isIntersecting||e.boundingClientRect.bottom<143||e.boundingClientRect.bottom>t}}].forEach(({type:n,isVisible:a,isHidden:i})=>{a(e)?this.lastLoggedVisibleEvent[n]||(this.addVisibleEvent(n,t),this.lastLoggedVisibleEvent[n]=!0):i(e)&&this.lastLoggedVisibleEvent[n]&&(this.addHiddenEvent(n,t),this.lastLoggedVisibleEvent[n]=!1)})}),a(this,"handleIntersectionChange",e=>{let t=e.intersectionRatio>0||e.isIntersecting,n=Date.now();this.handleIntersectionVisibilityChange(e,n),t&&!this.inViewport?(this.startTime=n,this.pinCellWidth=this.node.offsetWidth,this.pinCellHeight=this.node.offsetHeight,this._debug(o.enter,{startTime:n,node:this.node}),this.enterCallbacks.forEach(e=>e())):!t&&this.inViewport&&(this._debug(o.exit,!0),this.exitCallbacks.forEach(e=>e(this.toJSON()))),this.inViewport=t}),this.enterCallbacks=[],this.exitCallbacks=[],this.inViewport=!1,this.node=e,this.startTime=0,this.debugId="",this.pinCellWidth=0,this.pinCellHeight=0,this.visibleEvents=new Map,this.hiddenEvents=new Map,this.lastLoggedVisibleEvent={1:!1,50:!1,80:!1,2:!1}}addVisibleEvent(e,t){let n=this.visibleEvents.get(e)||[];n.push(1e6*t),this.visibleEvents.set(e,n)}addHiddenEvent(e,t){let n=this.hiddenEvents.get(e)||[];n.push(1e6*t),this.hiddenEvents.set(e,n)}hasVisibleEvent(e){return this.visibleEvents.has(e)}hasHiddenEvent(e){return this.hiddenEvents.has(e)}onEnterViewport(e){return this.enterCallbacks.push(e),this}onExitViewport(e){return this.exitCallbacks.push(e),this}setDebugId(e){return this.debugId=e,i&&Object.assign(this.node.style,r.init(e)),this}pause(){return this.inViewport&&(this.addHiddenEvent(102,Date.now()),this._debug(o.paused,!0),this.exitCallbacks.forEach(e=>e(this.toJSON()))),this}resume(){if(this.inViewport){let e=Date.now();this._debug(o.resumed,{startTime:e}),this.startTime=e,this.addVisibleEvent(102,e),Object.keys(this.lastLoggedVisibleEvent).forEach(e=>{this.lastLoggedVisibleEvent[e]=!1}),this.lastIntersectionChange&&this.handleIntersectionVisibilityChange(this.lastIntersectionChange,e)}return this}stop(e){return this.inViewport&&(this._debug(o.stopped,!0),this.exitCallbacks.forEach(t=>t(this.toJSON(e)))),this}toJSON(e=""){return{startTime:1e6*this.startTime,endTime:1e6*Date.now(),forcedExit:e,pinCellWidth:this.pinCellWidth,pinCellHeight:this.pinCellHeight,visibleEvents:this.visibleEvents,hiddenEvents:this.hiddenEvents}}toDebugJSON(){return{pinID:this.debugId,startTime:this.startTime,endTime:Date.now(),duration:`${(Date.now()-this.startTime)/1e3} seconds`,pinCellWidth:this.pinCellWidth,pinCellHeight:this.pinCellHeight}}_debug(e,t){if(i)switch(window.console.log(`ðŸ“Œ ${e} -- ${this.debugId}`),!0===t&&window.console.log(this.toDebugJSON()),"object"==typeof t&&window.console.log(t),r[e]&&Object.assign(this.node.style,r[e]),e){case o.flushed:case o.paused:case o.exit:l[this.debugId]=!0}}}function u(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let p=!0,_=!1;class c{constructor(){u(this,"_delegateChange",e=>{e.forEach(e=>{let t=this.activeImpressions.get(e.target);t&&t.handleIntersectionChange(e)})}),u(this,"_handleMutations",(e,t)=>{let n=this.mutationObservers.get(t);n&&n.offsetHeight<1&&n&&this.stop(n,"removed")}),this.activeImpressions=new Map,this.mutationObservers=new Map,this.bottomHeight=0,this.bottomObstructions=new Set,this.pausePriority=_,this.observer=new window.IntersectionObserver(this._delegateChange),window.Cypress&&!window.activeImpressions&&(window.activeImpressions=new Map),this.paused=!1,this.topHeight=0,this.topObstructions=new Set,this.inExperiment=!1}setExperimentStatus(e){this.inExperiment!==e&&(this.inExperiment=e)}stop(e,t=""){let n=this.activeImpressions.get(e);n&&(n.stop(t),n.mutationObserver&&this.mutationObservers.delete(n.mutationObserver),n.stopMutationObserver(),this.activeImpressions.delete(e),window.activeImpressions?.delete(e),this.observer?.unobserve(e))}start(e){let t=this.activeImpressions.get(e);if(!t){t=new d(e),this.activeImpressions.set(e,t),window.activeImpressions?.set(e,t),this.observer?.observe(e);let n=(e,t)=>this._handleMutations(e,t);t.setMutationObserver(new window.MutationObserver(n)),t.mutationObserver&&this.mutationObservers.set(t.mutationObserver,e),t.startMutationObserver({subtree:!0,attributes:!0,attributeFilter:["style"]})}return t}pause(e=p){this.paused||(Array.from(this.activeImpressions.values()).forEach(e=>e.pause()),this.paused=!0,this.pausePriority===_&&(this.pausePriority=e))}resume(e=p){(e!==_||this.pausePriority!==p)&&this.paused&&(Array.from(this.activeImpressions.values()).forEach(e=>e.resume()),this.paused=!1,this.pausePriority=_)}addObstruction(e,t){"top"===e?this.topObstructions.add(t):"bottom"===e&&this.bottomObstructions.add(t),this._calculateRootMargins()}removeObstruction(e,t){"top"===e?this.topObstructions.delete(t):"bottom"===e&&this.bottomObstructions.delete(t),this._calculateRootMargins()}updateObstructions(){this._calculateRootMargins()}_calculateRootMargins(){let e=Array.from(this.topObstructions).reduce((e,t)=>{let{bottom:n}=t.getBoundingClientRect();return n>e?n:e},0),t=window.innerHeight-Array.from(this.bottomObstructions).reduce((e,t)=>{let{top:n}=t.getBoundingClientRect();return n<e?n:e},window.innerHeight);if(e!==this.topHeight||t!==this.bottomHeight){let n={rootMargin:`${-e}px 0px ${-t}px`,threshold:[0,.5,.8,1]};this.observer?.disconnect(),this.observer=new window.IntersectionObserver(this._delegateChange,n),Array.from(this.activeImpressions.values()).forEach(e=>this.observer?.observe(e.node)),this.topHeight=e,this.bottomHeight=t}}}},609252:function(e,t,n){n.d(t,{Z:()=>a});let a=new(n(936367)).ZP},331357:function(e,t,n){n.d(t,{J:()=>o,U:()=>g});var a=n(27399),i=n(767415);let o="nic_v4",l=`${o}=1a`,s=`${o}=1b`,r=[l,s],d=["invite_code","invite","board_invite_code","sender"],u=null,p=e=>!!d.find(t=>e.includes(t)),_=e=>{let t;return e.pathname.includes("/pin/")&&!p(e.search)&&(t=e.search,!r.find(e=>t.includes(e)))},c=async e=>{let{resource_response:t}=await a.Z.create("InviteSocialTrackingParamNonInviteResource",{user_id:e}).callCreate();if(!t)return(0,i.nP)(`${o}.social_tracking_pin_non_invite.no_resource_response`),"";{let e=encodeURIComponent(t.data);return(0,i.nP)(`${o}.social_tracking_pin_non_invite.encrypted.${e?"true":"false"}`),e}},h=(e,t,n=!1,a)=>{if(!_(e))return;let r=n?"mweb":"web";if(!t)return void(0,i.nP)(`${r}.${o}.social_tracking_pin_non_invite.insert.no_encrypted_id`);(0,i.nP)(`${r}.${o}.social_tracking_pin_non_invite.insert.attempt`);try{let d=((e,t,n)=>{let a=e.search?"&":"?";return e.pathname+e.search+(a+(n?s:l)+t)})(e,t,n||!1);(0,i.nP)(`${r}.${o}.social_tracking_pin_non_invite.insert.success`),a(d)}catch{(0,i.nP)(`${r}.${o}.social_tracking_pin_non_invite.insert.caught_exception`)}},g=(e,t,n,a,l)=>{let s=n?"mweb":"web";(0,i.nP)(`${s}.${o}.social_tracking_pin_non_invite.attempt`);try{let r;!n&&a&&_(e)?((0,i.nP)(`${s}.${o}.social_tracking_pin_non_invite.search_string_eligible`),((e,t,n=!1,a)=>{u?h(e,u,n,a):(async()=>{let i=await c(t);u=i,h(e,i,n,a)})()})(e,t,n,l)):(r=e.search,!p(r)&&!r.includes("sender")&&r.includes(o)&&(0,i.nP)(`${s}.${o}.social_tracking_pin_non_invite.search_string_land`))}catch{(0,i.nP)(`${s}.${o}.social_tracking_pin_non_invite.caught_exception`)}}},456871:function(e,t,n){n.d(t,{Z:()=>p});var a=n(312048),i=n(331357),o=n(173874),l=n(774838),s=n(843716),r=n(900907),d=n(986523),u=n(767415);function p(){let e,{isBot:t,isSocialBot:n,referrerFromCookie:p,referrerFromHeader:_,countryFromHostName:c,countryFromIp:h,regionFromIp:g,isAuthenticated:m}=(0,l.B)(),b=(0,a.TH)(),v=(0,d.Z)(),w=new URLSearchParams(b.search),y=!t&&!!w.get("utm_pai"),S=w.get("utm_source"),O=!t&&!n&&(0,o.hasInviteCode)(b),I=(0,r.Z)({countryFromHostName:c||"",countryFromIp:h||"",regionFromIp:g||"",isAuthenticated:m}),C=_||I&&p||"";e=v||!I?C:(0,s.an)(C);let E=!1,f=!t&&!n&&S&&["email",String(31)].includes(S),P=!t&&!n&&S&&["fb"].includes(S),T="offsite"===S,L=!t&&!n&&!!(e&&(/facebook/.test(e)||/fb/.test(e))),N=!t&&!n&&!!(e&&(/twitter/.test(e)||/tw/.test(e)));O&&(0,u.nP)("unauth.entry_channel.invite_code",{sampleRate:1}),f&&(0,u.nP)("unauth.entry_channel.email_utm_source",{sampleRate:1}),P&&(0,u.nP)("unauth.entry_channel.social_media_utm_source_fb",{sampleRate:1}),T&&(0,u.nP)("unauth.entry_channel.offsite_utm_source",{sampleRate:1}),L&&(0,u.nP)("unauth.entry_channel.social_media_referer_fb",{sampleRate:1}),N&&(0,u.nP)("unauth.entry_channel.social_media_referer_twitter",{sampleRate:1}),E=(0,s.Xn)(e);let M=!t&&E,k=!!w.get(i.J),U=!!w.get("twa_type")||e&&e.startsWith("android-app://com.pinterest.twa"),x=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","utm_admin","utm_id","utm_mail","utm_swu"].some(e=>null!==w.get(e))||!!e||k||U;return{isPaid:y,isInvite:O,utmSource:S,referrer:e,isSocial:O,isDirect:!t&&!y&&!O&&!M&&!x,isSEO:M,isBrowserStorageAllowed:I,isOffsite:T,isBot:t||n}}},969809:function(e,t,n){n.d(t,{Z:()=>a});let a=e=>{switch(e){case"BR":case"MX":case"AR":case"CL":case"CO":return"LatAm";case"US":return"US";default:return"OTHER"}}},843716:function(e,t,n){n.d(t,{Xn:()=>g,Yf:()=>w,an:()=>m});var a=n(173874),i=n(138482),o=n(575820);let l="BING",s="GOOGLE",r="YAHOO",d="YANDEX",u="RAKUTEN",p="NAVER",_="AMP_CACHE",c="DUCKDUCKGO",h=[s,l,r,d,u,p,_,c];function g(e){return h.includes(function(e){let{hostname:t}=(0,o.Qc)(e,!0);if(t&&e){if(t.includes("google.")||e.includes("android-app://com.google.android.googlequicksearchbox"))return s;else if(t.includes("bing."))return l;else if(t.includes("yahoo."))return r;else if(t.includes("yandex."))return d;else if(t.includes("rakuten."))return u;else if(t.includes("naver."))return p;else if(t.includes("duckduckgo."))return c;else if(t.includes(".cdn.ampproject.org"))return _}return""}(e))}function m(e){return e||"undefined"!=typeof document&&document.referrer||""}let b=e=>"/"!==e[e.length-1]?`${e}/`:e,v=e=>{let t=b(e),n=(0,a.createRouterLocation)({url:t});return(0,a.isCloseupPage)(n)?"PIN":(0,a.isBoardPage)(n)?"BOARD":(0,i.Z)(n)?"PROFILE":(0,a.isAnyTodayPage)(n)?"TODAY":(0,a.isAnyIdeasPage)(n)?"IDEA":(0,a.isAnyShoppingPage)(n)?"SHOPPING":"UNKNOWN"},w=({country:e,language:t,isBot:n,hostname:a,pathname:i})=>({domain:a,country:e,language:t,currentUrl:i,pageType:v(i),referrer:document.referrer,isBot:n,links:(({selector:e,skipExternal:t})=>{let n=Array.from(document.querySelectorAll(e)),a={pin:[],board:[],user:[],today:[],idea:[],shopping:[]},i=new Set;return n.forEach(e=>{let n=e.getAttribute("href");if(!n||n.startsWith("#")||t&&n.startsWith("http")&&!n.includes(window.location.hostname))return;let o=b(n);if(i.has(o))return;i.add(o);let l=v(o);"PIN"===l?a.pin.push(o):"BOARD"===l?a.board.push(o):"PROFILE"===l?a.user.push(o):"TODAY"===l?a.today.push(o):"IDEA"===l?a.idea.push(o):"SHOPPING"===l&&a.shopping.push(o)}),a})({selector:"a[href]",skipExternal:!0})})},434291:function(e,t,n){n.d(t,{m:()=>i,r:()=>o});var a=n(815271);function i(e,t){(0,a.Z)("ðŸŽ¯ ENGAGEMENT_SCORE_CALCULATED",{trigger:e,...t})}function o(e,t){(0,a.Z)("desktop"===e?"DESKTOP_UPSELL_DECISION":"MOBILE_UPSELL_DECISION",t)}},116412:function(e,t,n){n.d(t,{U:()=>i,a:()=>o});var a=n(935833);function i({PES:e,NUS:t,conversionIntentLevel:n,triggerAction:i,deviceType:o}){(0,a.My)("engagement_score.calculated",{engagement_score:e,upsell_negative_score:t,user_intent_bucket:n,upsell_type_tag:"conversion",trigger_action:i,device_type:o})}function o({upsellType:e,decision:t,intentLevel:n,PES:i,NUS:o,experimentVariant:l}){(0,a.My)("upsell.decision_with_intent",{upsell_type:e,decision:t,intent_level:n,pes:i,nus:o,experiment_variant:l})}},184285:function(e,t,n){n.d(t,{HZ:()=>v,ZP:()=>L,e_:()=>T,pT:()=>I});var a=n(667294),i=n(581722),o=n(312048),l=n(15881),s=n(95664),r=n(79271),d=n(456871),u=n(774838),p=n(418282),_=n(270922),c=n(739405),h=n(658375),g=n(767415);let m=Date.now(),b=()=>(0,i.v9)(e=>e.upsell?.mWebSignupModal.modal.isShown??!1),v=()=>(0,i.v9)(e=>e.upsell?.modal),w=()=>(0,r.OC)(),y=()=>Date.now()-m,S=()=>(0,i.v9)(e=>e.upsell?.mWebSignupModal.isUnauthSharingModalsShown??!1),O=()=>(0,i.v9)(e=>!!e.upsell?.mWebSignupModal.modalHasShown),I=()=>(0,i.v9)(e=>e.upsell?.mWebSignupModal),C=()=>{let e=(0,u.B)(),t=(0,d.Z)(),n=(0,c.ZP)(),i=(0,o.TH)();return(0,a.useMemo)(()=>(0,_.T9)(e,t,n,i.pathname),[e,t,n,i.pathname])},E=Object.freeze(["CO","ID"]),f=e=>E.includes(e),P=e=>{if(!(0,s.ry)(e))return!1;let t=(0,p.Nl)();return t.getItem(l.QV)||((0,g.nP)("mobile_signup_modal.rules.suppress_for_social_in_app_browser"),t.setItem(l.QV,"1")),!0},T=({isModalShown:e,isUnauthSharingModalsShown:t,modalHasShown:n,country:a,userAgent:i})=>!e&&!(t||n&&f(a)||(0,h.P)()||P(i));function L(){let e=b(),t=(0,i.v9)(e=>e.upsell?.mWebSignupModal.modal),n=(0,i.v9)(e=>e.upsell?.mWebSignupModal.upsellEligibleNavigationCount),o=S();return{isModalShown:e,modal:t,upsellEligibleNavigationCount:n,isUnauthSharingModalsShown:o,modalHasShown:O(),sessionContext:C(),isUpsellEnabledGlobally:(()=>{let e=b(),t=S(),n=O(),i=C();return(0,a.useCallback)(()=>!e&&!(({isUnauthSharingModalsShown:e,modalHasShown:t,sessionContext:n})=>{if(!n)return!1;let{country:a,userAgent:i}=n;return e||t&&f(a)||(0,h.P)()||P(i)})({isUnauthSharingModalsShown:t,modalHasShown:n,sessionContext:i}),[e,t,n,i])})(),getPinImpressionCount:w,getSessionDuration:y}}},432414:function(e,t,n){n.d(t,{ZW:()=>P,Gk:()=>f,YM:()=>T});var a=n(173874),i=n(138482),o=n(434291),l=n(116412),s=n(730056);let r="dweb_eoq_q3_standard",d="dweb_eoq_q3_advanced",u="mweb_eoq_q3_standard",p="mweb_eoq_q3_advanced",_="mweb_eoq_q4_advanced_ucan",c="mweb_eoq_q4_emergency_ucan",h="mweb_eoq_q4_advanced_non_ucan",g="mweb_eoq_q4_emergency_non_ucan",m="dweb_eoq_q4_advanced_ucan",b="dweb_eoq_q4_emergency_ucan",v="dweb_eoq_q4_advanced_non_ucan",w="dweb_eoq_q4_emergency_non_ucan",y=[{bundleId:"dweb_eoq_q3_standard",experimentKey:r,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}}}},{bundleId:"dweb_eoq_q3_advanced",experimentKey:d,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"mweb_eoq_q3_standard",experimentKey:u,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}}}},{bundleId:"mweb_eoq_q3_advanced",experimentKey:p,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_advanced_ucan",experimentKey:_,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_emergency_ucan",experimentKey:c,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0},seo:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_advanced_non_ucan",experimentKey:h,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"mweb_eoq_q4_emergency_non_ucan",experimentKey:g,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0},seo:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}},{bundleId:"dweb_eoq_q4_advanced_ucan",experimentKey:m,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_advanced_non_ucan",experimentKey:v,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_emergency_ucan",experimentKey:b,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:0}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"dweb_eoq_q4_emergency_non_ucan",experimentKey:w,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:0}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}}];function S(e,t){let n=y.filter(n=>{if(!n.active||!n.overrides[e])return!1;switch(n.experimentKey){case r:return t("dweb_eoq_q3_standard").anyEnabled;case d:return t("dweb_eoq_q3_advanced").anyEnabled;case u:return t("mweb_eoq_q3_standard").anyEnabled;case p:return t("mweb_eoq_q3_advanced").anyEnabled;case _:return t("mweb_eoq_q4_advanced_ucan").anyEnabled;case c:return t("mweb_eoq_q4_emergency_ucan").anyEnabled;case h:return t("mweb_eoq_q4_advanced_non_ucan").anyEnabled;case g:return t("mweb_eoq_q4_emergency_non_ucan").anyEnabled;case m:return t("dweb_eoq_q4_advanced_ucan").anyEnabled;case b:return t("dweb_eoq_q4_emergency_ucan").anyEnabled;case v:return t("dweb_eoq_q4_advanced_non_ucan").anyEnabled;case w:return t("dweb_eoq_q4_emergency_non_ucan").anyEnabled;default:return!1}});return n[n.length-1]?.overrides[e]}let O=e=>({id:e.id,evaluate:function({ruleId:e,baseEvaluateFunction:t}){return n=>{let{checkExperiment:a,session:i}=n,o=a&&S(e,a)?.evaluateContextOverride||{},l=o[i?.channel??"default"]||o.default||{};return t((0,s.Z)(n,l))}}({ruleId:e.id,baseEvaluateFunction:e.evaluate}),getNextState:function({ruleId:e,baseNextStateFunction:t}){return({action:n,state:a,decision:i})=>{let o=t({action:n,state:a,decision:i});if(!("payload"in n&&"object"==typeof n.payload&&null!==n.payload&&"checkExperiment"in n.payload))return o;let l=S(e,n.payload.checkExperiment)?.stateOverride||{};return 0===Object.keys(l).length?o:(0,s.Z)(o,l)}}({ruleId:e.id,baseNextStateFunction:e.getNextState})});var I=n(671220),C=n(224841);let E=(e,t)=>{let n={enabled_1:["high","medium"],enabled_2:["high"],enabled_3:["medium"],enabled_4:["medium","low"]}[t];return!!n&&n.includes(e||"unknown")},f={shouldShowRelatedPinsGradientUpsell:O({id:"desktop_related_pins_gradient_upsell_trigger",evaluate:({relatedPinsGradientUpsellEverShown:e,checkExperiment:t})=>{if(e)return!1;let n=t?.("ce_dweb_unauth_related_pins_limit");return!!n?.anyEnabled},getNextState:({state:e})=>({...e,showRelatedPinsGradientUpsell:!0,relatedPinsGradientUpsellEverShown:!0})}),shouldShowCloseupNavigationalModal:O({id:"closeup_navigational_modal_trigger",evaluate:({pinViewCount:e,navigationalPagesUpsellSeen:t,checkExperiment:n})=>!n?.("pc_no_navigational_upsell").anyEnabled&&(e??0)>=4&&!t,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_1",container:"closeup",reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}),shouldShowSaveModal:O({id:"save_modal_trigger",evaluate:()=>!0,getNextState:({action:e,state:t})=>({...t,pinSaveCount:t.pinSaveCount+1,pinId:e.payload.pinId,attributionLabel:e.payload.attributionLabel,showSaveModal:!0,modal:{isShown:!0,displayProps:{attributionLabel:e.payload.attributionLabel,container:"save",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",savePinId:e.payload.pinId,signupFlow:{type:"signup"},source:"saveButtonExp"}}})}),shouldShowNavigationalModal:O({id:"desktop_navigational_modal_trigger",evaluate:({uniqueNavigationalPagesSeen:e=[],navigationalPagesUpsellSeen:t,navigationalPagesViewThresholdDesktop:n,checkExperiment:a})=>!a?.("pc_no_navigational_upsell").anyEnabled&&e.length>=(n??4)&&!t,getNextState:({state:e,action:t})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_${t.payload.containerPage}`,container:t.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}),shouldShowNavigationalModalIntentBased:O({id:"desktop_navigational_modal_intent_trigger",evaluate:({navigationalPagesUpsellSeen:e,engagementScore:t,checkExperiment:n})=>{let a=n?.("engagement_score_v0_dweb");if(!a?.anyEnabled||e)return!1;let{conversionIntentLevel:i,PES:s,NUS:r}=t||{},d=E(i,a.group);return(0,o.r)("desktop",{variant:a.group,decision:d?"SHOW":"SKIP",intentLevel:i,PES:s||0,NUS:r||0,reason:d?`Intent ${i} in allowed list`:`Intent ${i} NOT in allowed list`}),(0,l.a)({upsellType:"navigation_desktop",decision:d?"show":"skip",intentLevel:i||"unknown",PES:s||0,NUS:r||0,experimentVariant:a.group}),d},getNextState:({state:e,action:t})=>{let{conversionIntentLevel:n,PES:a,NUS:i}=e.engagementScore||{};return{...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_intent_${n}_pes_${a||0}_nus_${i||0}`,container:t.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0}}}),shouldShowSignupModalOnCloseUpClick:O({id:"closeup_modal_trigger",evaluate:({modal:e,clickCloseUp:t})=>!e?.isShown&&!t,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_closeup",container:"pinWash",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickCloseUp:!0})}),shouldShowSignupModalOnClickContextMenuSaveButton:O({id:"context_menu_save_button_trigger",evaluate:({modal:e,clickContextMenuSaveButton:t})=>!e?.isShown&&!t,getNextState:({action:e,state:t})=>{let n;return n=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...t,modal:{isShown:!0,displayProps:n},clickContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnClickCloseupSaveButton:O({id:"closeup_save_button_trigger",evaluate:({modal:e,clickCloseUpContextMenuSaveButton:t})=>!e?.isShown&&!t,getNextState:({action:e,state:t})=>{let n;return n=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...t,modal:{isShown:!0,displayProps:n},clickCloseUpContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnContextMenuDownloadClick:O({id:"desktop_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:t,modal:n})=>!!((e||t)&&!n?.isShown),getNextState:({action:e,state:t})=>{let n;return n=e.payload.inDwebSwapDownloadUpsellExp?{signupFlow:{type:"login"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"lopDownloadUpsell",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"lopDownloadUpsell"}:{signupFlow:{type:"signup"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId},{...t,modal:{isShown:!0,displayProps:n},clickContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnCloseupDownloadClick:O({id:"closeup_download_button_trigger",evaluate:({limitReached:e,modal:t})=>!!(e&&!t?.isShown),getNextState:({action:e,state:t})=>({...t,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId}},clickCloseUpContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource})}),shouldShowSignupModalOnFollowButtonClick:O({id:"follow_button_trigger",evaluate:({modal:e,clickFollowButton:t})=>!e?.isShown&&!t,getNextState:({action:e,state:t})=>({...t,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",container:e.payload.isContextualFollowEnabled?"follow":"",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:e.payload.isContextualFollowEnabled?"followButton":void 0}},clickFollowButton:!0})}),shouldShowSignupModalOnFollowingButtonClick:O({id:"following_button_trigger",evaluate:({modal:e,clickFollowingButton:t})=>!e?.isShown&&!t,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_following",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowingButton:!0})}),shouldShowSignupModalOnFollowersButtonClick:O({id:"followers_button_trigger",evaluate:({modal:e,clickFollowersButton:t})=>!e?.isShown&&!t,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_followers",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowersButton:!0})}),shouldShowLoginModalOnCommentComposerClick:O({id:"comment_composer_trigger",evaluate:({modal:e,clickCommentComposerUpsell:t})=>!e?.isShown&&!t,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"tap_unauth_comment_composer",container:"closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"commentComposer"}},clickCommentComposerUpsell:!0})}),shouldShowLoginModalOnRelatedPinOpenLinkClick:O({id:"related_pin_open_link_trigger",evaluate:({modal:e,clickRelatedPinOpenLinkUpsell:t})=>!e?.isShown&&!t,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"click_context_menu_related_pin_right_click_open_link_button",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickRelatedPinOpenLinkUpsell:!0})}),shouldShowLoginModalOnPinLinkClick:O({id:"pin_link_trigger",evaluate:({modal:e,pinLinkClickCount:t=0})=>!e?.isShown&&(2===t||t%5==0),getNextState:({action:e,state:t})=>({...t,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"pinLinkClickHandler_tier1",container:"hybrid_clickthrough",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickPinLinkCount:e.payload.count})}),shouldShowSocialPinLandingModal:O({id:"social_pin_landing_modal_trigger",evaluate:({inviter:e,socialPinLandingModalShown:t,checkExperiment:n})=>{if(!e||t)return!1;let a=n?.("ce_dweb_unauth_splp_blocking").anyEnabled,i=n?.("ce_dweb_unauth_splp_blocking_no_delay").anyEnabled,o=n?.("ce_dweb_unauth_splp_blocking_3s").anyEnabled;return!!(a||i||o)},getNextState:({action:e,state:t})=>({...t,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.type===I.Fy?`delay_${e.payload.containerPage}`:`scroll_${e.payload.containerPage}`,container:e.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},socialPinLandingModalShown:!0})}),shouldShowScrollingBox:{id:"desktop_scrolling_box_trigger",evaluate:({checkExperiment:e})=>!e?.("pc_no_navigational_upsell").anyEnabled,getNextState:({state:e})=>e}},P={shouldShowSaveEducationPopover:O({id:"mobile_save_education_popover_trigger",evaluate:({saveEducationPopoverEverShown:e,checkExperiment:t})=>{if(e)return!1;let{group:n}=t?.("ce_mweb_unauth_social_feature_education")||{};return!!n?.startsWith("enabled_group_board")},getNextState:({state:e})=>({...e,showSaveEducationPopover:!0,saveEducationPopoverEverShown:!0})}),shouldShowReplyToSenderSheet:O({id:"mobile_reply_to_sender_sheet_trigger",evaluate:({replyToSenderSheetEverShown:e,checkExperiment:t})=>{if(e)return!1;let{group:n}=t?.("ce_mweb_unauth_social_feature_education")||{};return!!n?.startsWith("enabled_reply_to_sender")},getNextState:({state:e})=>({...e,showReplyToSenderSheet:!0,replyToSenderSheetEverShown:!0})}),shouldAllowUnauthSave:O({id:"mobile_unauth_save_quota_check",evaluate:({isPPMAndroidUnauthExperience:e,isFromUnauthContextMenu:t,currentUnauthSaves:n=0,mobileUnauthSaveThreshold:a})=>!t&&!e&&n<(a??2),getNextState:({action:e,state:t})=>({...t,mWebSignupModal:{...t.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(t.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:t.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:e.payload.headingType,trigger:{attributionLabel:"extended_save_out_of_quota"===e.payload.headingType?"click_save_button_with_max_unauth_saves":e.payload.attributionLabel||"click_save_button_on_closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})}),shouldShowMainPinImageNavigationalModal:O({id:"mobile_main_pin_image_modal",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:t,isModalCurrentlyShown:n,learningUpsellScenario:a,forceShowModal:i})=>{let o=a&&t&&!n&&(e?.("mweb_unauth_main_learning_pin_full_page").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced_row").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled||e?.("mweb_q2_mau_push_pc_eu_safe").anyEnabled);return a&&(i||!!o)},getNextState:({action:e,state:t})=>({...t,mWebSignupModal:{...t.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(t.mWebSignupModal?.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:t.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:"none",trigger:{attributionLabel:"navigation_main_pin_image_click",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})}),shouldShowMainPinImageAppUpsell:{id:"mobile_main_pin_app_upsell_purple_banner",getNextState:({state:e})=>e,evaluate:({learningUpsellScenario:e,hasConversionUpsell:t,isLearningAppUpsellShown:n})=>t||!e?{shouldToggleAppUpsell:!1,currentlyShowing:!1,newState:!1}:{shouldToggleAppUpsell:!0,currentlyShowing:n,newState:!n}},shouldShowNavigationUpsell:O({id:"mobile_navigation_upsell",evaluate:({isUpsellEnabledGlobally:e,isModalCurrentlyShown:t,newLocation:n,isNavigationFromSwipe:a,currentNavigationCount:i,hasSeenModal:o,pageThreshold:l,isWashDismissible:s,canShowSignupModalOnRouteChange:r,navigationalPagesViewThresholdMobile:d,checkExperiment:u})=>{if(u?.("pc_no_navigational_upsell").anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};let p=d||l||4;if(t)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!(e&&!a))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};let _=!!n&&!!u&&(0,C.Z)(u,n);if(!(n&&r?.(n,_)))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(!((i??0)>=p)||o)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let c=u?.("mweb_feature_upsell_copy_visual_combination_v2",{dangerouslySkipActivation:!0});return{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_${p}_${i}`,allowCloseOnOutsideClick:s,headingType:c?.anyEnabled?"mweb_feature_upsell_copy_visual_combination_v2":"none"}},getNextState:({state:e,decision:t})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:t?.headingType??"none",trigger:{attributionLabel:t?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!t?.allowCloseOnOutsideClick},pinId:null}}})}),shouldShowNavigationUpsellIntentBased:O({id:"mobile_navigation_upsell_intent",evaluate:({isUpsellEnabledGlobally:e,isModalCurrentlyShown:t,newLocation:n,isNavigationFromSwipe:a,hasSeenModal:i,canShowSignupModalOnRouteChange:s,engagementScore:r,checkExperiment:d})=>{let u=d?.("engagement_score_v0_mweb");if(!u?.anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};let p=!!n&&!!d&&(0,C.Z)(d,n);if(t)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!e||a||!n||!s?.(n,p))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(i)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let{conversionIntentLevel:_,PES:c,NUS:h}=r||{},g=E(_,u.group);if((0,o.r)("mobile",{variant:u.group,decision:g?"SHOW":"SKIP",intentLevel:_,PES:c||0,NUS:h||0,reason:g?`Intent ${_} in allowed list`:`Intent ${_} NOT in allowed list`}),(0,l.a)({upsellType:"navigation_mobile",decision:g?"show":"skip",intentLevel:_||"unknown",PES:c||0,NUS:h||0,experimentVariant:u.group}),!g)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let m=d?.("mweb_feature_upsell_copy_visual_combination_v2",{dangerouslySkipActivation:!0});return{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_intent_${_}_pes_${c||0}_nus_${h||0}`,allowCloseOnOutsideClick:!0,headingType:m?.anyEnabled?"mweb_feature_upsell_copy_visual_combination_v2":"none"}},getNextState:({state:e,decision:t})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:t?.headingType??"none",trigger:{attributionLabel:t?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!t?.allowCloseOnOutsideClick},pinId:null}}})}),shouldShowOnLandUpsell:O({id:"mobile_on_land_upsell",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:t,hasSeenNavUpsell:n,location:o,userAgent:l,showUnauthMwebSocialDefaultModalUpsell:s,isSocialInAppBrowser:r,shouldTriggerOnLand:d=!1})=>{let u;if(e?.("pc_no_navigational_upsell").anyEnabled)return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let p=!!o&&!!e&&(0,C.Z)(e,o);if(!t||n||!(o&&((0,a.isCloseupPage)(o)||(0,a.isBoardPage)(o)||(0,i.Z)(o)||(0,a.isSearchPage)(o)||(0,a.hasInviteCode)(o)||p&&(0,a.isAnyIdeasPage)(o))))return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let _=!(r?.(l)&&e?.("mweb_unauth_social_iab_upsell_boost_experiment",{dangerouslySkipActivation:!0}).anyEnabled)&&s;if(!s&&!d)return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let c=_?null:e?.("mweb_feature_upsell_copy_visual_combination_v2",{dangerouslySkipActivation:!0}),h=c?.anyEnabled??!1;if("social"==(u=_?"social":h?"mweb_feature_upsell_copy_visual_combination_v2":"none")&&e){let t=e("ce_mweb_visual_plp_upsell");if(t.anyEnabled)switch(t.group){case"enabled_1":u="social_visual_1";break;case"enabled_2":u="social_visual_2";break;case"enabled_3":u="social_visual_3"}}return{shouldShowModal:!0,shouldIncrementCount:!0,showUnauthMwebSocialUpsell:_,modalConfig:{reason:"UPSELL_LOGIN_OR_SIGNUP",attributionLabel:"navigation_0",navigationTriggeredUpsell:{newLocation:o,oldLocation:o},headingType:u}}},getNextState:({state:e,decision:t})=>{let{modalConfig:n}=t;return{...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:n?.headingType,trigger:{attributionLabel:n?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:null}}}}}),shouldShowSignupModalOnContextMenuDownloadClick:O({id:"mobile_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:t,modal:n})=>(e||t)&&!n?.isShown,getNextState:({action:e,state:t})=>{let{inMwebDownloadCTAExp:n,showDownloadCloseupIcon:a,attributionLabelSource:i}=e.payload,o={trigger:{attributionLabel:`click_${i}_download_button`,reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},headingType:n||a?"download_limit_reached":"none"};return{...t,mWebSignupModal:{...t.mWebSignupModal,modal:{isShown:!0,displayProps:o,pinId:e.payload.pinId??""}}}}}),shouldShowSignupModalOnFollowButtonClickMobile:O({id:"follow_button_trigger_mobile",evaluate:({mWebSignupModal:e})=>!e?.modal.isShown,getNextState:({action:e,state:t})=>({...t,mWebSignupModal:{...t.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(t.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:t.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:e.payload.isContextualFollowEnabled?"follow":"none",trigger:{attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0}}}})}),shouldShowFloatingBanner:{id:"mobile_floating_banner_trigger",evaluate:({checkExperiment:e})=>!e?.("pc_no_navigational_upsell").anyEnabled,getNextState:({state:e})=>e}},T={desktop:f,mobile:P}},671220:function(e,t,n){n.d(t,{dn:()=>F,UA:()=>Q,ub:()=>el,EH:()=>ec,Ik:()=>M,qH:()=>eU,mV:()=>A,OU:()=>p,Gh:()=>g,LL:()=>ew,Li:()=>eu,jB:()=>en,G5:()=>em,CC:()=>eY,F8:()=>eE,Ue:()=>Z,kQ:()=>G,h4:()=>$,g_:()=>Y,t:()=>ez,rA:()=>k,BF:()=>ep,aj:()=>eV,qD:()=>eR,IS:()=>eZ,it:()=>R,Yr:()=>B,Vi:()=>q,by:()=>b,wK:()=>z,i8:()=>S,K7:()=>h,fC:()=>ex,GY:()=>eL,uy:()=>C,HK:()=>w,f$:()=>J,qs:()=>X,vY:()=>ed,yC:()=>eq,Fy:()=>H,QG:()=>O,OX:()=>I,WE:()=>eI,CH:()=>eB,qT:()=>v,Dk:()=>er,Bh:()=>j,qq:()=>eQ,Nx:()=>f,$S:()=>P,Lu:()=>ea,k7:()=>eD,Qm:()=>eH,Pp:()=>L,Sy:()=>eo,b9:()=>eb,z1:()=>ei,$y:()=>u,tP:()=>E,Zr:()=>x,sg:()=>et,QC:()=>ek,Hm:()=>ev,uV:()=>eT,FV:()=>eS,o9:()=>eG,MZ:()=>eX,V9:()=>K,AS:()=>c,kd:()=>U,pp:()=>_,QA:()=>eg,tW:()=>eC,v2:()=>ef,Jw:()=>ej,w$:()=>es,Pu:()=>e$,gU:()=>e0,cD:()=>ey,P9:()=>T,YT:()=>eK,pZ:()=>eF,dL:()=>eh,XE:()=>eM,Ff:()=>eA,tA:()=>V,TQ:()=>ee,Q4:()=>y,gH:()=>D,aJ:()=>W,C5:()=>e_,Aw:()=>eW,xY:()=>eO,Dw:()=>eJ,Bi:()=>N,ap:()=>eP,ht:()=>eN,mX:()=>m});var a=n(95664),i=n(935833),o=n(184285),l=n(432414);let s=e=>{let{modal:t,mWebSignupModal:n,appUpsells:a}=e;return!!(t.isShown||n.modal.isShown||a.learningUpsell?.isShown||a.iabAppUpsell?.isShown)};var r=n(932921),d=n(767415);let u="PROCESS_MOBILE_NAVIGATION_CHANGE",p="SET_UPSELL_REASON",_="UPS_EVENT_PIN_VIEW",c="UPS_EVENT_PIN_SAVE",h="UPS_EVENT_DESKTOP_MODAL_SHOW",g="UPS_EVENT_DESKTOP_MODAL_DISMISSED",m="CLICK_CLOSE_UP_CONTEXT_MENU_SAVE_BUTTON",b="CLICK_CLOSE_UP_CONTEXT_MENU_DOWNLOAD_BUTTON",v="TRIGGER_SCROLL_DOWN_UPSELL",w="CLEAR_SCROLL_DOWN_UPSELL",y="DISMISS_BOTTOM_RIGHT_BANNER",S="TRIGGER_SAVE_EDUCATION_POPOVER",O="CLEAR_SAVE_EDUCATION_POPOVER",I="TRIGGER_RELATED_PINS_GRADIENT_UPSELL",C="CLEAR_RELATED_PINS_GRADIENT_UPSELL",E="TRIGGER_REPLY_TO_SENDER_SHEET",f="CLEAR_REPLY_TO_SENDER_SHEET",P="CLICK_CLOSEUP_UPSELL",T="CLICK_CONTEXT_MENU_SAVE_BUTTON_UPSELL",L="CLICK_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",N="CLICK_FOLLOW_BUTTON_UPSELL",M="CLICK_FOLLOWING_BUTTON_UPSELL",k="CLICK_FOLLOWERS_BUTTON_UPSELL",U="CLICK_COMMENT_COMPOSER_UPSELL",x="CLICK_PIN_LINK_UPSELL",R="CLICK_RELATED_PIN_OPEN_LINK_UPSELL",D="RECORD_NAVIGATIONAL_PAGE",A="SET_INITIAL_SESSION_CONTEXT",G="UPDATE_LATEST_L1_VERTICAL",F="RESET_UPSELL_TRIGGER_STATE",W="RECORD_SOCIAL_PIN_LANDING_PAGE",H="TRIGGER_SOCIAL_DELAY_MODAL",q="TRIGGER_SOCIAL_SCROLL_MODAL",B="SHOW_MOBILE_SIGNUP_MODAL",V="DISMISS_MOBILE_SIGNUP_MODAL",$="SET_MOBILE_SIGNUP_MODAL_TOP_INTEREST",Z="INCREMENT_UPSELL_ELIGIBLE_NAVIGATION_COUNT",K="HIDE_UNAUTH_SHARING_MODALS",Q="SHOW_UNAUTH_SHARING_MODALS",j="RESTORE_FROM_LOCAL_STORAGE",Y="MAIN_PIN_IMAGE_CLICK_MOBILE",X="ON_LAND_UPSELL_MOBILE",J="SET_LEARNING_UPSELL_VISIBILITY",z="CLICK_MOBILE_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",ee="DISMISS_MOBILE_FLOATING_UPSELL",et="CLICK_FOLLOW_BUTTON_UPSELL_MOBILE",en="INCREMENT_PIN_SAVE_COUNT",ea="DECREMENT_PIN_SAVE_COUNT",ei="INCREMENT_UNAUTH_CLICKTHROUGH_COUNT",eo="SET_UNAUTH_DOWNLOAD_COUNT",el="UPS_EVENT_PIN_SAVE_MOBILE",es="SET_REFERRED_APP_UPSELL_STATE",er=e=>({type:j,payload:{upsellEligibleNavigationCount:e}}),ed=e=>({type:p,payload:{upsellReason:e}}),eu=(e,t,n,a,i)=>({type:_,payload:{pinId:e,seoUrl:t,componentType:n,viewParameter:a,checkExperiment:i}}),ep=(e,t)=>({type:c,payload:{pinId:e,attributionLabel:t}}),e_=()=>({type:g}),ec=()=>({type:y}),eh=e=>({type:h,payload:{displayProps:e}}),eg=()=>({type:P}),em=(e,t,n)=>({type:T,payload:{pinId:e,attributionLabelSource:t,signupToLoginExpGroup:n}}),eb=(e,t)=>({type:N,payload:{isIdeaPin:e,isContextualFollowEnabled:t}}),ev=(e,t,n,a)=>({type:m,payload:{pinId:e,attributionLabelSource:t,signupToLoginExpGroup:n,checkExperiment:a}}),ew=({pinId:e,attributionLabelSource:t,downloadAllowedCallback:n})=>({checkExperiment:a,sessionContext:o})=>(o,l)=>{let d=l(),{limitReached:u,oldCount:p,newCount:_}=(0,r.H)(a,{downloadCount:d.upsell?.unauthDownloadCount??0,upsellDispatch:o,isAuthenticated:d.session?.isAuthenticated??!1});(0,i.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:t,limitReached:u,oldCount:p,newCount:_}),o({type:b,payload:{pinId:e,attributionLabelSource:t,limitReached:u,checkExperiment:a}}),s(l().upsell)||n()},ey=({pinId:e,attributionLabelSource:t,inImmediateUpsellGroup:n,inDwebSwapDownloadUpsellExp:a,downloadAllowedCallback:o,showDownloadIconForRelatedPins:l,inDwebDownloadCTAExp:d})=>({checkExperiment:u,sessionContext:p})=>(p,_)=>{let c=_(),{limitReached:h,oldCount:g,newCount:m}=(0,r.H)(u,{downloadCount:c.upsell?.unauthDownloadCount??0,upsellDispatch:p,isAuthenticated:c.session?.isAuthenticated??!1});l?(0,i.My)("dweb.unauth.action_bar.download_image",{attributionLabelSource:t,limitReached:h,oldCount:g,newCount:m}):d?(0,i.My)("dweb.unauth.download_cta.download_image",{attributionLabelSource:t}):a?(0,i.My)("dweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:t}):(0,i.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:t,limitReached:h,oldCount:g,newCount:m}),p({type:L,payload:{pinId:e,attributionLabelSource:t,limitReached:h,inImmediateUpsellGroup:n,inDwebSwapDownloadUpsellExp:a,checkExperiment:u}}),s(_().upsell)||o()},eS=()=>({type:M}),eO=()=>({type:k}),eI=()=>({type:U}),eC=e=>({type:x,payload:{count:e}}),eE=()=>({type:R}),ef=(e,t)=>({checkExperiment:n,sessionContext:a})=>i=>{i({type:D,payload:{pageUniqueKey:e,containerPage:t,checkExperiment:n,sessionContext:a}})},eP=e=>({type:A,payload:{sessionContext:e}}),eT=e=>({type:G,payload:{l1Vertical:e}}),eL=(e,t)=>({type:W,payload:{inviter:e,containerPage:t}}),eN=e=>({checkExperiment:t})=>n=>{n({type:H,payload:{containerPage:e,checkExperiment:t}})},eM=e=>({checkExperiment:t})=>n=>{n({type:q,payload:{containerPage:e,checkExperiment:t}})},ek=()=>({type:O}),eU=()=>({checkExperiment:e})=>t=>{t({type:I,payload:{checkExperiment:e}})},ex=()=>({type:C}),eR=()=>({checkExperiment:e,sessionContext:t})=>n=>{let{group:a}=e?.("ce_mweb_unauth_social_feature_education")||{};a?.startsWith("enabled_group_board")?n((({checkExperiment:e})=>t=>{t({type:S,payload:{checkExperiment:e}})})({checkExperiment:e,sessionContext:t})):a?.startsWith("enabled_reply_to_sender")&&n((({checkExperiment:e})=>t=>{t({type:E,payload:{checkExperiment:e}})})({checkExperiment:e,sessionContext:t}))},eD=()=>({type:f}),eA=e=>({type:B,payload:e}),eG=()=>({type:V}),eF=e=>({type:$,payload:{topInterest:e}}),eW=()=>({type:Z}),eH=()=>({type:K}),eq=()=>({type:Q}),eB=e=>({checkExperiment:t,sessionContext:n})=>(a,o)=>{a({type:u,payload:{...e,checkExperiment:t,sessionContext:n}}),s(o().upsell)||(0,i.My)(`mweb.nav.upsell.show.${e.currentNavigationCount}`)},eV=e=>({checkExperiment:t,sessionContext:n})=>(s,r)=>{let u=r().upsell,{country:p,userAgent:_}=n,c=l.YM.mobile.shouldShowOnLandUpsell?.evaluate({checkExperiment:t,isUpsellEnabledGlobally:(0,o.e_)({isModalShown:u.mWebSignupModal.modal.isShown??!1,isUnauthSharingModalsShown:u.mWebSignupModal.isUnauthSharingModalsShown??!1,modalHasShown:!!u.mWebSignupModal.modalHasShown,country:p,userAgent:_}),hasSeenNavUpsell:u.mWebSignupModal.modalHasShown,location:e.location,isPaid:e.isPaid,isSocial:e.isSocial,isDirect:e.isDirect,isSEO:e.isSEO,userAgent:_,showUnauthMwebSocialDefaultModalUpsell:e.showUnauthMwebSocialDefaultModalUpsell,isSocialInAppBrowser:a.ry,session:n});c.shouldShowModal&&c.modalConfig&&((0,i.My)("mweb.nav.upsell.show.0"),c.showUnauthMwebSocialUpsell&&(0,d.nP)("unauth.mweb.social.pin.upsell",{sampleRate:1}),s({type:X,payload:{decision:c,checkExperiment:t}}))},e$=e=>({checkExperiment:t,sessionContext:n})=>(a,o)=>{let s=o().upsell,r=!!s.appUpsells.learningUpsell?.isShown,d=l.YM.mobile.shouldShowMainPinImageNavigationalModal?.evaluate({checkExperiment:t,session:n,isUpsellEnabledGlobally:e.upsellContext.isUpsellEnabledGlobally(),isModalCurrentlyShown:e.upsellContext.isModalShown,learningUpsellScenario:e.learningUpsellScenario}),u=l.YM.mobile.shouldShowMainPinImageAppUpsell?.evaluate({learningUpsellScenario:e.learningUpsellScenario,hasConversionUpsell:!!d,isLearningAppUpsellShown:r});d?(0,i.My)("mweb.nav.upsell.show.main_pin_image_click"):u.shouldToggleAppUpsell?u.currentlyShowing?e.trackInteraction({action:"dismiss",item:"learning-upsell"}):e.trackInteraction({action:"click",item:"learning-upsell"}):e.onImageClick(),a({type:Y,payload:{conversionDecision:d,appUpsellDecision:u,checkExperiment:t,pinId:e.pinId}})},eZ=({isShown:e,isDismissedByUser:t=!1})=>({type:J,payload:{isShown:e,isDismissedByUser:t}}),eK=({pinId:e,attributionLabelSource:t,inImmediateUpsellGroup:n,inMwebDownloadCTAExp:a,showDownloadCloseupIcon:o,downloadAllowedCallback:l})=>({checkExperiment:d,sessionContext:u})=>(u,p)=>{let _=p(),{limitReached:c,oldCount:h,newCount:g}=(0,r.H)(d,{downloadCount:_.upsell?.unauthDownloadCount??0,upsellDispatch:u,isAuthenticated:_.session?.isAuthenticated??!1});a?(0,i.My)("mweb.unauth.download_cta.download_image",{attributionLabelSource:t}):o?(0,i.My)("mweb.unauth.download_closeup_icon.download_image",{attributionLabelSource:t}):(0,i.My)("mweb.unauth.context_menu.download_image",{attributionLabelSource:t,limitReached:c,oldCount:h,newCount:g}),u({type:z,payload:{pinId:e,attributionLabelSource:t,limitReached:c,inImmediateUpsellGroup:n,inMwebDownloadCTAExp:a,showDownloadCloseupIcon:o,checkExperiment:d}}),s(p().upsell)||l()},eQ=({isDismissedByUser:e=!1}={})=>({type:ee,payload:{isDismissedByUser:e}}),ej=(e,t)=>({type:et,payload:{isIdeaPin:e,isContextualFollowEnabled:t}}),eY=()=>({type:ea}),eX=()=>({type:ei}),eJ=e=>({type:eo,payload:{count:e}}),ez=e=>({checkExperiment:t,sessionContext:n})=>(n,a)=>{let i=a().upsell;l.YM.mobile.shouldAllowUnauthSave?.evaluate({checkExperiment:t,isPPMAndroidUnauthExperience:e.isPPMAndroidUnauthExperience,isFromUnauthContextMenu:e.isFromUnauthContextMenu,currentUnauthSaves:e.unauthSavedPinsStore.pins.length})&&!i.mWebSignupModal.modal.isShown?(e.unauthSavedPinsStore.save({id:e.pinId,nodeId:e.nodeId,imageUrl:e.getPinGifOrImageSrc({imagesUrls:e.imagesUrls,embedSrc:e.embedSrc,embedType:e.embedType,excludeOriginals:!e.isBot&&!e.isSocialBot})}),n({type:en}),e.handleShowNavFooter(n,e.forceShowNavFooter,e.isNavBarHidden,e.setForceShowNavFooter),e.successCallback&&e.successCallback()):n({type:el,payload:{attributionLabel:e.isFromUnauthContextMenu?e.attributionLabel||"click_save_button_on_closeup":"click_save_button_with_max_unauth_saves",headingType:e.isFromUnauthContextMenu?"save":"extended_save_out_of_quota",pinId:e.pinId,checkExperiment:t}})},e0=({isShown:e,appUpsellType:t,isBlocking:n})=>({type:es,payload:{isShown:e,appUpsellType:t,isBlocking:n}})},270922:function(e,t,n){n.d(t,{A4:()=>r,T9:()=>d,qo:()=>s,y1:()=>l});var a=n(95664),i=n(969809),o=n(238957);let l=e=>e?(0,i.Z)(e.toUpperCase()):"OTHER",s=e=>e.isPaid?"paid":e.isInvite?"invite":e.isSocial?"social":e.isSEO?"seo":e.utmSource?`utm_${e.utmSource}`:"direct",r=e=>e&&"string"==typeof e?(0,a.$K)(e)?"pinterest":(0,a.dh)(e)?"instagram":/wechat|micromessenger/i.test(e)?"wechat":(0,a.ry)(e)||/facebook|fbav|fban|tiktok|twitter|line/i.test(e)?"social":"none":"none",d=(e,t,a,i)=>{let d=e?.countryFromHostName||e?.country||"",u=e?.userAgent?.raw||("undefined"!=typeof navigator?navigator.userAgent:""),p=r(u),_=(e=>{let{isAnyTodayPage:t,isHubOrIdeaPage:a,isBoardSectionPage:i,isBoardPage:o,isCloseupPage:l,isHomePage:s,isSearchPage:r,isTopicPage:d}=n(173874),u=n(138482).Z,p={pathname:e};return t(p)?"today":a(p)?"ideas":i(p)?"section":o(p)?"board":l(p)?"closeup":s(p)?"home":u(p)?"profile":r(p)?"search":d(p)?"topic":""})(i),c=(0,o.iU)();return{country:d,userAgent:u,referrer:e?.referrerFromHeader||e?.referrerFromCookie||"",unauthID:e?.unauthId||"",region:l(d),channel:s(t),iab:p,isIAB:"instagram"===p||"wechat"===p||"social"===p,landingPageType:_,deviceType:a,revisitationState:c,revisitationCount:c.count,daysSinceLastVisit:(e=>{let{ts:t}=e;if(!t||0===t)return 0;let n=new Date,a=new Date(t);return Math.max(Math.floor(Number(((n.getTime()-a.getTime())/864e5).toFixed(2))),0)})(c)}}},986523:function(e,t,n){n.d(t,{Z:()=>s});var a=n(667294);let i=()=>()=>{},o=()=>!1,l=()=>!0,s=()=>(0,a.useSyncExternalStore)(i,o,l)},281213:function(e,t,n){n.d(t,{H:()=>d,W:()=>u});var a=n(667294),i=n(230201),o=n(213491),l=n(501010),s=n(785893);let{Provider:r,get:d}=(0,o.Z)("VideoPlayer");function u({children:e}){let{logContextEvent:t,logImpression:n}=(0,i.u)(),{checkExperiment:o}=(0,l.Z)(),[d,u]=(0,a.useState)(!1),[p,_]=(0,a.useState)([]),[c,h]=(0,a.useState)([]),[g,m]=(0,a.useState)({}),b=o("web_ads_mrc_video_impression").anyEnabled,v=e=>{m(t=>({...t,[e]:!0}))},w=(0,a.useCallback)(e=>{if(18===e.event_type&&e.event_data?.pinImpressions?.length){let{isNativeVideoAndWatchable:t}=e.event_data.pinImpressions[0],n=JSON.stringify(e.aux_data?.commerce_data||"").includes("story_pin_id");b&&(t||n)&&_(t=>[...t,e].slice(-1e3))}},[b]),y=(0,a.useCallback)(e=>{18===e.eventType&&b&&h(t=>[...t,e].slice(-1e3))},[b]);(0,a.useEffect)(()=>{let e=p.filter(e=>{let{pinIdStr:n}=e.event_data.pinImpressions[0];return!g[n]||!b||(t((e=>{let{time:t}=e.event_data.pinImpressions[0];return{...e,event_data:{...e.event_data,pinImpressions:[{...e.event_data.pinImpressions[0],isMrcBtr:!0,endTime:t,renderDuration:0}]}}})(e)),!1)});e.length!==p.length&&_(e)},[p,b,t,g]),(0,a.useEffect)(()=>{let e=c.filter(e=>{let t=e.eventData?.pinIdStr;if(!t)return!1;if(g[t]&&b){let t=(e=>{if(e.eventData){let{time:t}=e.eventData;return{...e,eventData:{...e.eventData,isMrcBtr:!0,endTime:t??0}}}return null})(e);return t&&n(t),!1}return!0});e.length!==c.length&&h(e)},[c,b,n,g]);let S=(0,a.useMemo)(()=>({captionsEnabled:d,logMrcVideoAdImpressionOnPlay:y,logMrcVideoAdEventOnPlay:w,setCaptionsEnabled:u,setVideoPlayed:v,videosPlayed:g}),[d,w,y,g]);return(0,s.jsx)(r,{value:S,children:e})}},932921:function(e,t,n){n.d(t,{H:()=>l,Z:()=>o});var a=n(935833),i=n(671220);async function o({filename:e,imgSrc:t,imageDownloadSuccessCallback:n,category:i,pinId:o,viewParameter:l,viewType:s,isUnauth:r=!1,platform:d="web",expName:u,expGroup:p},_){return"undefined"==typeof window?Promise.resolve():((0,a.My)("web.download.click",{category:i||"no_category",authType:r?"unauth":"auth",platform:d,viewType:s,expName:u,expGroup:p}),_({event_type:82,object_id_str:o,view_type:s||3,view_parameter:l||139}),t&&document)?fetch(t,{headers:new Headers({Origin:window.location.origin}),mode:"cors"}).then(e=>e.blob()).then(t=>{let o=document.createElement("a");o.href=window.URL.createObjectURL(t),e&&o.setAttribute("download",e.replace(".","_")),o.style.display="none",document.body?.appendChild(o),o.click(),document.body?.removeChild(o),(0,a.My)("web.download.success",{category:i||"no_category",authType:r?"unauth":"auth",platform:d,viewType:s,expName:u,expGroup:p}),n?.()}).catch(()=>{throw(0,a.My)("web.download.failure",{category:i||"no_category",authType:r?"unauth":"auth",platform:d,viewType:s,expName:u,expGroup:p}),Error("Download image error")}):Promise.resolve()}let l=(e,t)=>{let{downloadCount:n=0,upsellDispatch:a,isAuthenticated:o,updateDownloadCount:l}=t||{};if(o)return{limitReached:!1,oldCount:0,newCount:0};if(e("unuath_download_paywalled").anyEnabled||e("unauth_combined_download_exp").anyEnabled)return{limitReached:!0,oldCount:0,newCount:0};let s=n>=1,r=s?n:n+1;return n!==r&&a&&(a((0,i.Dw)(r)),l?.()),{limitReached:s,oldCount:n,newCount:r}}},224841:function(e,t,n){n.d(t,{Z:()=>i});var a=n(173874);function i(e,t,n=!1){return!!(0,a.isAnyIdeasPage)(t)&&e?.("lop_eoq_lever_nav_mweb",{dangerouslySkipActivation:n}).anyEnabled}},358198:function(e,t,n){n.d(t,{BW:()=>h,WW:()=>_});var a=n(686659),i=n(667294),o=n(15881),l=n(213491),s=n(501010),r=n(418282),d=n(767415),u=n(785893);let{Provider:p,getMaybe:_}=(0,l.Z)("CloseupNearDupSigsTracker"),c=({children:e})=>{(0,i.useEffect)(()=>{(0,a.Z)("CloseupNearDupSigsTrackerContext","/app/www/closeup/CloseupNearDupSigsTrackerContext.tsx")},[]);let t=(0,r.Nl)(),n=(0,i.useRef)([]),l=(0,i.useRef)(new Set),s=(0,i.useRef)([]),_=(0,i.useRef)(new Set),c=(0,i.useRef)([null,[]]),h=(0,i.useCallback)(()=>{t.setItem(o.S4,n.current),t.setItem(o.yb,s.current)},[t]),g=(0,i.useCallback)(()=>{let e=t.getItem(o.S4),a=t.getItem(o.yb);if(e)try{Array.isArray(e)&&e.every(e=>"string"==typeof e)&&(n.current=e.slice(-5),l.current=new Set(n.current))}catch(e){(0,d.nP)("closeup_page.near_dup.session_storage_sync.closeup.fail",{sampleRate:1})}if(a)try{Array.isArray(a)&&a.every(e=>"string"==typeof e)&&(s.current=a.slice(-35),_.current=new Set(s.current))}catch(e){(0,d.nP)("closeup_page.near_dup.session_storage_sync.impression.fail",{sampleRate:1})}},[n,s,t]),m=(0,i.useCallback)(e=>{if(_.current.has(e)&&(s.current=s.current.filter(t=>t!==e)),s.current.length>=35){let e=s.current.shift();e&&_.current.delete(e)}_.current.add(e),s.current.push(e)},[]),b=(0,i.useCallback)(e=>{if(l.current.has(e)&&(n.current=n.current.filter(t=>t!==e)),n.current.length>=5){let e=n.current.shift();e&&l.current.delete(e)}l.current.add(e),n.current.push(e),h()},[h]),v=(0,i.useCallback)(e=>{let[t,a]=c.current;if(t===e)return a;0===n.current.length&&0===s.current.length&&g();let i=Array.from(new Set([...s.current,...n.current]));return c.current=[e,i],i},[g]);(0,i.useEffect)(()=>h,[h]);let w=(0,i.useMemo)(()=>({addImpression:m,addCloseup:b,getTrackedNearDupSigs:v}),[m,b,v]);return(0,u.jsx)(p,{value:w,children:e})},h=({children:e})=>{(0,i.useEffect)(()=>{(0,a.Z)("CloseupNearDupSigsTrackerContext","/app/www/closeup/CloseupNearDupSigsTrackerContext.tsx")},[]);let{checkExperiment:t}=(0,s.Z)();return t("web_closeup_rabbit_hole_dedup").anyEnabled?(0,u.jsx)(c,{children:e}):(0,u.jsx)(p,{value:void 0,children:e})}},2061:function(e,t,n){n.d(t,{Yg:()=>r,ib:()=>u,nF:()=>_,xX:()=>p});var a=n(501010),i=n(774838),o=n(739405),l=n(767415);let s=({checkExperiment:e})=>{let{group:t}=e("auth_mweb_graphql_pin_page",{dangerouslySkipActivation:!0});return{logStat:(e,n)=>(0,l.nP)("webapp.graphql.debug_auth_mweb_graphql_pin_page",{sampleRate:1,tags:{event:e,group:t,...n}})}},r=()=>{let{isAuthenticated:e}=(0,i.B)(),t=(0,o.HG)(),{checkExperiment:n}=(0,a.Z)();return e&&!t?s({checkExperiment:n}):{logStat:()=>{}}},d=0,u=({checkExperiment:e,isAuthMweb:t})=>{if(!t)return;let{logStat:n}=s({checkExperiment:e});(d+=1)<10&&n(`repin_${d}`)};function p({checkExperiment:e,isDesktop:t,isAuthenticated:n}){if(!n)return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!1};if(t){let{anyEnabled:t}=e("auth_dweb_graphql_pin_page");return{isGraphQLEnabledForRelatedPins:t,isGraphQLEnabledInGeneral:t,shouldPrefetchCloseupPreviewFragment:!1}}{let{anyEnabled:t,group:n}=e("auth_mweb_graphql_pin_page");switch(n){case"control":return{isGraphQLEnabledInGeneral:!1,isGraphQLEnabledForRelatedPins:!1,shouldPrefetchCloseupPreviewFragment:!1};case"enabled":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!1};case"enabled_prefetch_closeup_data":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!0};case"only_closeup":return{isGraphQLEnabledInGeneral:!0,isGraphQLEnabledForRelatedPins:!1,shouldPrefetchCloseupPreviewFragment:!1};case"only_related_pins":return{isGraphQLEnabledInGeneral:!1,isGraphQLEnabledForRelatedPins:!0,shouldPrefetchCloseupPreviewFragment:!1};default:return{isGraphQLEnabledInGeneral:t,isGraphQLEnabledForRelatedPins:t,shouldPrefetchCloseupPreviewFragment:!1}}}}function _(){let{checkExperiment:e}=(0,a.Z)(),t=(0,o.HG)(),{isAuthenticated:n}=(0,i.B)();return p({checkExperiment:e,isDesktop:t,isAuthenticated:n})}},163691:function(e,t,n){n.d(t,{Z:()=>a});let a=function(e){return{...e,ts:Date.now()}}},238957:function(e,t,n){n.d(t,{K7:()=>r,Vd:()=>u,WT:()=>s,iU:()=>d});var a=n(4533),i=n(994507),o=n(34550),l=n(163691);let s=18e5,r=i.dm,d=()=>{try{let{count:e,time:t,ts:n}=(0,o.M0)().getItem(a.SI)??{};if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return{count:e,time:t,ts:n};throw Error("Invalid revisitation data")}catch(e){return(0,i.dm)()}},u=e=>{(0,o.M0)().setItem(a.SI,(0,l.Z)(e))}},658375:function(e,t,n){n.d(t,{C:()=>l,P:()=>o});var a=n(173874),i=n(767415);let o=()=>!1,l=e=>{(0,a.isDiscoverArticlePage)(e)&&!o()&&(0,i.nP)("mobile_signup_modal.rules.suppress_for_discover_article",{flushImmediate:!0,sampleRate:1})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/51723-212c70a83d6e6f56.mjs.map